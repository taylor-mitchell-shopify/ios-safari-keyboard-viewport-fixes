<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>iOS Safari Viewport Shift Solutions</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
      line-height: 1.6;
      padding: 20px;
      max-width: 800px;
      margin: 0 auto;
      background: #f5f5f7;
    }
    h1 {
      color: #1d1d1f;
      margin-bottom: 10px;
      font-size: 28px;
    }
    .subtitle {
      color: #6e6e73;
      margin-bottom: 30px;
      font-size: 14px;
    }
    .solutions {
      background: white;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .solution {
      display: block;
      padding: 16px 20px;
      color: inherit;
      text-decoration: none;
      border-bottom: 1px solid #e5e5e7;
      transition: background-color 0.2s;
      position: relative;
      cursor: pointer;
    }
    .solution:hover {
      background-color: #f5f5f7;
    }
    .solution:last-child {
      border-bottom: none;
    }
    .solution-name {
      font-size: 16px;
      font-weight: 500;
      margin-bottom: 4px;
      color: #1d1d1f;
      display: block;
    }
    .solution-path {
      font-size: 12px;
      color: #6e6e73;
      display: block;
    }
    .solution-description {
      margin-top: 8px;
      font-size: 13px;
      color: #4a4a4f !important;  /* Slightly darker grey than path */
      line-height: 1.4;
      display: block;
      width: 100%;
      box-sizing: border-box;
    }
    .solution-description p {
      margin: 0;
      padding: 0;
      margin-bottom: 6px;
      color: #4a4a4f !important;  /* Ensure paragraph text is grey */
      display: block;
    }
    .solution-description p:last-child {
      margin-bottom: 0;
    }
    .solution:hover .solution-description {
      color: #4a4a4f;  /* Keep grey on hover */
    }
    .solution:hover .solution-description p {
      color: #4a4a4f;  /* Keep grey on hover */
    }
    .solution-description a {
      color: #007aff !important;  /* Keep links blue */
      text-decoration: none;
    }
    .solution-description a:hover {
      text-decoration: underline;
    }
    .info {
      background: #fff3cd;
      border: 1px solid #ffc107;
      border-radius: 8px;
      padding: 12px 16px;
      margin-bottom: 20px;
      font-size: 14px;
      color: #856404;
    }
    .deployment-info {
      background: white;
      border-radius: 8px;
      padding: 12px 16px;
      font-size: 14px;
    }
    .deployment-info strong {
      color: #007aff;
    }
    .about {
      margin-top: 40px;
      padding: 20px;
      background: white;
      border-radius: 8px;
      margin-bottom: 20px;
    }
    .about h2 {
      font-size: 20px;
      margin-bottom: 10px;
    }
    .about p {
      color: #6e6e73;
      font-size: 14px;
    }
    .section-header {
      margin: 0;
      padding: 20px 20px 12px;
      font-size: 13px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #86868b;
      background: linear-gradient(to bottom, #fafafa, transparent);
      border-top: 1px solid #e5e5e7;
      position: relative;
    }
    .section-header:first-child {
      border-top: none;
      background: none;
      padding-top: 20px;
    }
    .section-header.success {
      color: #34c759;
    }
    .section-header.warning {
      color: #ff9500;
    }
    .section-header::before {
      content: '';
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      width: 3px;
      height: 16px;
      border-radius: 2px;
      margin-right: 8px;
    }
    .section-header.success::before {
      background: #34c759;
    }
    .section-header.warning::before {
      background: #ff9500;
    }
    .section-header span {
      margin-left: 12px;
    }
  </style>
</head>
<body>
  <h1>iOS Safari Viewport Shift Solutions</h1>
  <p class="subtitle">Test various solutions for the iOS Safari viewport shift bug</p>
  
  <div class="about">
    <h2>About This Collection</h2>
    <p>
      This collection contains various approaches to handle the iOS Safari viewport shift bug 
      where content is shifted when the keyboard appears. Each solution demonstrates a different technique 
      for managing the viewport and element positioning when the keyboard appears.
    </p>
    <p style="margin-top: 10px;">
      These solutions explore different strategies including visual viewport API, dynamic viewport units,
      meta viewport configurations, iframe workarounds, and React hooks for preventing viewport shift.
    </p>
    <p style="margin-top: 15px;">
      <strong>Resources:</strong><br>
      üì¶ <a href="https://github.com/taylor-mitchell-shopify/ios-safari-keyboard-viewport-fixes" target="_blank" style="color: #007aff;">GitHub Repository</a><br>
      üêõ <a href="https://github.com/shop/issues-shop-wallet/issues/289" target="_blank" style="color: #007aff;">Related Issue</a>
    </p>
  </div>
  
  <div class="solutions">
    <h2 class="section-header success"><span>‚úì Kinda Works</span></h2>

    <div class="solution" onclick="window.location.href='solutions/iframe-decoy-solution/'" style="cursor: pointer;">
      <div class="solution-name">iFrame Decoy Solution</div>
      <div class="solution-path">/solutions/iframe-decoy-solution/</div>
      <div class="solution-description">
        <p>
          This solution uses a decoy input that is positioned high enough to prevent the viewport from shifting when the keyboard appears.
          In checkout, the login screen is in an iframe, so we also used one in this prototype in case it caused any issues.
        </p>
        <p>
          Based on this article: <a href="https://blog.opendigerati.com/the-eccentric-ways-of-ios-safari-with-the-keyboard-b5aa3f34228d" target="_blank" onclick="event.stopPropagation();">The Eccentric Ways of iOS Safari with the Keyboard</a>
        </p>
      </div>
    </div>

    <div class="solution" onclick="window.location.href='solutions/chatgpt-solution-5-tranform-with-js/'" style="cursor: pointer;">
      <div class="solution-name">ChatGPT Solution 5: Transform with JavaScript</div>
      <div class="solution-path">/solutions/chatgpt-solution-5-tranform-with-js/</div>
      <div class="solution-description">
        <p>
          Uses the Visual Viewport API to counter the keyboard shift by adjusting a fixed header's transform on keyboard open. Keeps the fixed header visually glued to the top of the screen as the keyboard changes the visual viewport's offset.
        </p>
      </div>
    </div>

    <h2 class="section-header warning"><span>‚ö† Doesn't Work</span></h2>

    <div class="solution" onclick="window.location.href='solutions/user-prevent-virtual-keyboard-scrolling/dist/'" style="cursor: pointer;">
      <div class="solution-name">User Prevent Virtual Keyboard Scrolling (React)</div>
      <div class="solution-path">/solutions/user-prevent-virtual-keyboard-scrolling/dist/</div>
      <div class="solution-description">
        <p>
          Use <a href="https://developer.mozilla.org/en-US/docs/Web/API/VirtualKeyboard/overlaysContent">virtualKeyboard.overlayContent</a> to disable all mucking with the viewport when the keyboard opens. shop-server uses this api in the <a href="https://github.com/Shopify/shop-server/blob/1d0b24bd162ef59458646e1ee6c7c0ef550154bd/areas/platforms/shop-server/engines/pay/app/ui/sections/components/IdentityServerDriven/steps/utils/usePreventVirtualKeyboardScrolling.ts">usePreventVirtualKeyboardScrolling</a> hook. <a href="https://developer.mozilla.org/en-US/docs/Web/API/VirtualKeyboard/overlaysContent#browser_compatibility">Unfortunately safari doesn't support it</a>
        </p>
      </div>
    </div>


    <div class="solution" onclick="window.location.href='solutions/chatgpt-solution-1-make-fixed-page-app/'" style="cursor: pointer;">
      <div class="solution-name">ChatGPT Solution 1: Fixed Page App</div>
      <div class="solution-path">/solutions/chatgpt-solution-1-make-fixed-page-app/</div>
      <div class="solution-description">
        <p>
          Creates a fixed app shell with scrolling content. Uses a robust pattern that avoids the bug by moving scrolling into an inner container with position: sticky header inside that container, keeping the header pinned regardless of keyboard state.
        </p>
      </div>
    </div>
    
    <div class="solution" onclick="window.location.href='solutions/chatgpt-solution-2-dynamic-viewport-units/'" style="cursor: pointer;">
      <div class="solution-name">ChatGPT Solution 2: Dynamic Viewport Units</div>
      <div class="solution-path">/solutions/chatgpt-solution-2-dynamic-viewport-units/</div>
      <div class="solution-description">
        <p>
          Avoids using 100vh on iOS and instead uses dynamic viewport units (dvh) with JavaScript fallback. Sets a custom --vh property that stays in sync with the visual viewport to handle keyboard changes.
        </p>
      </div>
    </div>
    
    <div class="solution" onclick="window.location.href='solutions/chatgpt-solution-3-meta-viewport/'" style="cursor: pointer;">
      <div class="solution-name">ChatGPT Solution 3: Meta Viewport</div>
      <div class="solution-path">/solutions/chatgpt-solution-3-meta-viewport/</div>
      <div class="solution-description">
        <p>
          Configures the meta viewport tag with viewport-fit=cover and uses safe-area-inset-top padding to handle full-bleed webviews and account for notches/status bars.
        </p>
      </div>
    </div>
    
    <div class="solution" onclick="window.location.href='solutions/chatgpt-solution-4-input-focus/'" style="cursor: pointer;">
      <div class="solution-name">ChatGPT Solution 4: Input Focus</div>
      <div class="solution-path">/solutions/chatgpt-solution-4-input-focus/</div>
      <div class="solution-description">
        <p>
          Prevents the browser from auto-scrolling the page when inputs are focused. Uses JavaScript to ensure focused inputs are visible without jumping the whole layout, scrolling only the inner container.
        </p>
      </div>
    </div>

  </div>
  
</body>
</html>